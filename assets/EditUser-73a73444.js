import{r as n,n as S,i as E,j as e}from"./index-b92ad479.js";import{a as x}from"./axios-f13eed09.js";import{S as i}from"./sweetalert2.all-58ecf48c.js";import{C as P,b as j,c as N}from"./DefaultLayout-dca0b3b8.js";import{h as v}from"./moment-fbc5633a.js";import"./index.es-f1a080d1.js";import"./cil-user-5af1b2f2.js";function q(){const[c,k]=n.useState({}),[u,_]=n.useState(!0),[T,w]=n.useState(!0),[Y,b]=n.useState(!0),[s,p]=n.useState({username:"",password:"",password_confirmation:"",first_name:"",last_name:"",father_name:"",national_code:"",gender:"male",birth_date:"",certificate_number:"",certificate_serial:"",certificate_date:"",certificate_place:"",education_level:"",phone:"",email:"",telephone:"",telephone_extension:"",postal_codes:"",address:"",signature:"",profile_picture:""}),{id:f}=S(),[m,F]=n.useState(v(new Date).format("YYYY/MM/DD"));let C=E();const g=()=>{x.get("users/"+f).then(t=>{console.log(t),p(t.data),_(!1),w(!0),b(!0)}).catch(t=>{console.log(t.response),i.fire({icon:"warning",title:"Warning",text:t.response.data.msg||"There was an error processing your request."}).then(()=>{C("/Users/manageUsers")})})};n.useEffect(()=>{g()},[]),n.useEffect(()=>{u?i.fire({title:"درحال پردازش ... ",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{i.showLoading()}}):i.close()},[u]);const y=function(t){t.preventDefault();const o=new FormData;m!=null&&m!=""&&o.append("birth_date",v(m).format("YYYY/MM/DD")),Object.entries(s).forEach(([r,l])=>{l!=null&&l!=""&&o.append(r,l)}),x.post("users/"+f,o,{headers:{"Content-Type":"multipart/form-data","X-HTTP-Method-Override":"PUT"}}).then(r=>{g(),i.fire({icon:"success",title:"Success",text:r.data.msg})}).catch(r=>{console.log(r.response),r.response.status==422&&i.fire({icon:"warning",title:"Warning",text:r.response.data.message||"There was an error processing your request."})})},D=(t,o)=>{console.log(t),console.log(" id :: ",o);const r=new FormData;r.append("file",t),x.post("/uploadFile",r).then(l=>{console.log(" uploadFile :: ",l.data),p(h=>({...h,[o]:l.data}))}).catch(l=>{console.log(l),i.fire({icon:"error",title:"error",text:l.response.data.message})})},a=t=>{const{id:o,value:r,type:l}=t.target;let h=r;if(l==="file"){const d=t.target.files[0];d&&D(d,o)}else p(d=>({...d,[o]:h}))};return e.jsx("div",{className:"container-xl p-5 ml-1 rounded",children:e.jsxs("form",{onSubmit:y,className:"border p-4",encType:"multipart/form-data",children:[e.jsx("div",{className:"row text-center bg-light",children:e.jsx("h3",{children:"فرم ویرایش کاربر"})}),e.jsx("br",{}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"username",children:"نام کاربری :"}),e.jsx("input",{value:s.username||"",onChange:a,type:"text",className:"form-control ",id:"username"}),c.username?e.jsx("span",{className:"text-danger font-size-error",children:c.username}):""]})}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"name",children:"نام :"}),e.jsx("input",{value:s.first_name||"",onChange:a,type:"text",className:"form-control ",id:"first_name"})]}),e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"last_name",children:"نام خانوادگی :"}),e.jsx("input",{value:s.last_name||"",onChange:a,type:"text",className:"form-control",id:"last_name"})]}),e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"father_name",children:"نام پدر :"}),e.jsx("input",{value:s.father_name||"",onChange:a,type:"text",className:"form-control ",id:"father_name"})]}),e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsxs("label",{className:"text-nowrap",htmlFor:"national_code",children:[" ","کد ملی :"]}),e.jsx("input",{value:s.national_code||"",onChange:a,type:"text",className:"form-control ",id:"national_code"})]}),e.jsxs("div",{className:"form-group col-md-1 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"gender",children:"جنسیت :"}),e.jsxs("select",{onChange:a,className:"form-select form-select-sm",id:"gender",children:[e.jsx("option",{value:"male",children:"مرد"}),e.jsx("option",{value:"female",children:"زن"})]})]}),e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"birth_day",children:"تاریخ تولد :"}),e.jsx(P,{firstDayOfWeek:6,date:m,placeholder:"",onStartDateChange:F,locale:"fa-IR",size:"sm"})]})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"certificate_number",children:"شماره شناسنامه :"}),e.jsx("input",{value:s.certificate_number||"",onChange:a,type:"text",className:"form-control ",id:"certificate_number"})]}),e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"certificate_serial",children:"سریال شناسنامه :"}),e.jsx("input",{value:s.certificate_serial||"",onChange:a,type:"text",className:"form-control ",id:"certificate_serial"})]}),e.jsxs("div",{className:"form-group col-md-3 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"education_level",children:"مدرک تحصیلی :"}),e.jsx("input",{value:s.education_level||"",onChange:a,type:"text",className:"form-control ",id:"education_level"})]})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"mobile",children:"تلفن همراه :"}),e.jsx("input",{value:s.phone||"",onChange:a,type:"text",className:"form-control",id:"phone"})]}),e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"email",children:"ایمیل :"}),e.jsx("input",{value:s.email||"",onChange:a,type:"text",className:"form-control ",id:"email"}),c.email?e.jsx("span",{className:"text-danger font-size-error",children:c.email}):""]}),e.jsxs("div",{className:"form-group col-md-2 mt-3 ml-0",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"telephone",children:"تلفن :"}),e.jsx("input",{value:s.telephone||"",onChange:a,type:"text",className:"form-control ",id:"telephone"})]}),e.jsx("div",{className:"form-group col-md-1 mt-5 text-center",children:"-"}),e.jsxs("div",{className:"form-group col-md-1 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"telephone_extension"}),e.jsx("input",{value:s.telephone_extension||"",onChange:a,type:"text",className:"form-control ",id:"telephone_extension"})]}),e.jsxs("div",{className:"form-group col-md-2 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"postal_codes",children:"کدپستی :"}),e.jsx("input",{value:s.postal_codes||"",onChange:a,type:"text",className:"form-control ",id:"postal_codes"})]})]}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"form-group col-md-12 mt-3",children:[e.jsx("label",{className:"text-nowrap",htmlFor:"address",children:"آدرس :"}),e.jsx("textarea",{value:s.address||"",onChange:a,rows:"3",className:"form-control row-3",id:"address"})]})}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"form-group col-md-3 mt-3",children:[e.jsx(j,{htmlFor:"formFile",children:"امضا :"}),e.jsx(N,{type:"file",onChange:a,accept:".pdf, .jpg, .jpeg, .png",id:"signature"}),s.signature!=""&&e.jsx("a",{href:`http://localhost:8000/${s.signature}`,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{className:"m-3 border border-dark",src:`http://localhost:8000/${s.signature}`,height:"100px",alt:"Preview"})})]})}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"form-group col-md-3 mt-3",children:[e.jsx(j,{htmlFor:"formFile",children:"عکس پروفایل :"}),e.jsx(N,{type:"file",onChange:a,accept:".pdf, .jpg, .jpeg, .png",id:"profile_picture"})]}),s.profile_picture!=""&&e.jsx("a",{href:`http://localhost:8000/${s.profile_picture}`,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{className:"m-3 border border-dark",src:`http://localhost:8000/${s.profile_picture}`,height:"100px",alt:"Preview"})})]}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("button",{type:"submit",className:"btn btn-success col-md-2 mt-3 center",children:"ویرایش کاربر"})})]})})}export{q as default};
